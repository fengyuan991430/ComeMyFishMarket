@using Microsoft.AspNetCore.Identity
@using ComeMyFishMarket.Areas.Identity.Data
@model IEnumerable<ComeMyFishMarket.Models.MarketOrder>
@inject UserManager<ComeMyFishMarketUser> UserManager

@{
    ViewData["Title"] = "ViewReport";
    string[] month_name = { "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December" };

}

<h1>View Report</h1>
@foreach (var sellername in ViewBag.Seller)
{


    var sellerid = await UserManager.FindByNameAsync(sellername);
    <p>@sellername: @sellerid.Id</p>
    double total = 0;

    @foreach (var item in Model)
    {
        if (item.HandledBy.Equals(sellerid.Id) && item.OrderDate.Year.Equals(ViewData["SelectedYear"]))
        {
            total += item.TotalAmount;
        }
    }
    <p>total amount 2021: @total</p>

}
<form method="post">
    <div class="row mb-5 mt-5">
        <div class="col-4">
            @Html.DropDownList("Year", ViewBag.Year, "All Year", new { @class = "form-control" })
        </div>
        <div class="col-4">
            <select class="form-control" name="Month">
                <option value="">All Month</option>
                @for (int i = 0; i < month_name.Length; i++)
                {
                    <option value="@(i+1)">@month_name[i]</option>
                }
            </select>
        </div>
        <div class="col-4">
            <input type="submit" class="form-control" value="Search" />
        </div>
    </div>
</form>

<script src="https://cdn.anychart.com/releases/8.9.0/js/anychart-base.min.js"></script>

<div id="chart_container_earn" class="chart"></div>
<script>
    anychart.onDocumentReady(function () {

        //data
        var data = anychart.data.set([
            ["John", 10000],
            ["Jake", 12000],
            ["Peter", 13000],
            ["James", 10000],
            ["Mary", 9000],
            { x: 'Department Stores', value: 737166 },
        ]);




        //create chart
        var chart = anychart.column();


        //create bar series and set data
        var design = chart.column(data);
        design.name("Total (RM)");
        design.labels(true);
        design.labels().fontColor("#000000");

        //set background
        chart.background().fill({
            keys: ["#b0b0b0 0.3", "#b0b0b0 0.4", "#b0b0b0 0.6"],
            angle: 90
        });

        //set fill
        design.normal().fill("#5c5cff", 0.7);
        design.hovered().fill("#00009e", 0.5);
        design.selected().fill("#00009e", 0.5);
        design.normal().stroke("#5c5cff", 0.7);
        design.hovered().stroke("#5c5cff", 0.7);
        design.selected().stroke("#5c5cff", 0.7);


        // format axis labels
        var axisLabels_x = chart.xAxis().labels();
        axisLabels_x.useHtml(true);
        axisLabels_x.format(
            "<a style=\"font-size:20px;color:black;font-family: 'Lucida Console', 'Courier New', monospace;\">{%value}</a>"
        );


        var axisLabels_y = chart.yAxis().labels();
        axisLabels_y.useHtml(true);
        axisLabels_y.format(
            "<a style=\"font-size:20px;color:black;font-family: 'Lucida Console', 'Courier New', monospace;\">{%value}</a>"
        );

        //set chart title
        var title = chart.title();
        title.enabled(true);
        title.useHtml(true);
        title.text(
            "<b style='font-size:34px;color:#000024'>Total Sales Report </b><br>" +
            "<b style='font-size:28px;color:#000024'>Year</b>" +
            "<br><br>"
        );

        // set the titles of the axis
        var title_x = chart.xAxis().title();
        title_x.enabled(true);
        title_x.useHtml(true);
        title_x.text(
            "<b style='font-size:25px;color:#000024'>Month</b>"
        );

        var title_y = chart.yAxis().title();
        title_y.enabled(true);
        title_y.useHtml(true);
        title_y.text(
            "<b style='font-size:25px;color:#000024'>Total (RM)</b><br>"
        );

        var labels = chart.xAxis().labels();
        labels.enabled(true);

        chart.container("chart_container_earn");
        chart.draw();

    });
</script>

<style>
    .chart {
        width: 100%;
        height: 500px;
        margin: 0;
        padding: 0;
    }
</style>